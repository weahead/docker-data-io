#!/bin/sh

set -e

SRC="/data.tar.gz"

echo
echo "Packing data..."
tar -zcf "${SRC}" -C /source .
echo "done."

if [ -n "${DATA_TAG}" ]; then
  data-io-registry pack "${SRC}"
elif [ -n "${DATA_S3_DST}" ]; then
  data-io-s3 pack "${SRC}"
else
  echo
  echo "Nowhere to send the packed data?"
fi

if [ $? = 0 ]; then
  echo
  echo "Finished successfully."
else
  echo "Unable to finish successfully."
  exit 1
fi
